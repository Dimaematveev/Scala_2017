6. Гистограмма


Гистограмма является многоугольником, сформированным из последовательности прямоугольников, выровненных на общей базовой линии. Прямоугольники имеют равную ширину, но могут иметь различные высоты. Обычно гистограммы используются для представления дискретных распределений, например, частоты символов в текстах. Отметьте, что порядок прямоугольников очень важен. Вычислите область самого большого прямоугольника в гистограмме, который также находится на общей базовой линии. На рисунке справа заштрихованная фигура является самым большим выровненным прямоугольником на изображенной гистограмме.


Входные данные:
В первой строке входного файла записано число N (0 ≤ N ≤ 106) — количество прямоугольников гистограммы. Затем следует N целых чисел h1...hn, где 0 ≤ hi ≤ 109. Эти числа обозначают высоты прямоугольников гистограммы слева направо. Ширина каждого прямоугольника равна 1.


Выходные данные:
Выведите площадь самого большого прямоугольника в гистограмме. Помните, что этот прямоугольник должен быть на общей базовой линии.


Решение:
Пусть l[i] — номер ближайшего столбца, который находится слева от столбца i и
ниже него (или -1, если такого нет). Аналогично определяется r[i] (только вместо
-1 будем использовать n). В максимальный прямоугольник входит столбец, высота
которого равна высоте прямоугольника. То есть площадь равна
h[i] * (r[i] - l[i] - 1) для некоторого i. Значит при наличии массивов l, r мы
умеем вычислять ответ. Чтобы посчитать r, достаточно пройти по массиву слева
направо, сохраняя в стеке столбцы. При обработке нового столбца из стека нужно
выкинуть все столбцы, которые ниже нового и сохранить для них значение r.